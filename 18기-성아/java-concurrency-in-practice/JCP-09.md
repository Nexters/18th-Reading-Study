## 스레드 기반 서비스 종료

- 스레드 풀 같이 내부적으로 스레드를 생성하는 서비스를 스레드 기반 서비스라고 한다.
- 스레드 기반의 서비스는 서비스를 시작시킨 메소드보다 오랜 시간 실행된다.
- 애플리케이션을 깔끔하게 종료시키려면 스레드 기반 서비스 내부의 스레드를 안전하게 종료시켜야 한다.
- 스레드의 소유권을 가졌을 때만 종료해야 한다. 하지만 스레드의 인스턴스는 다른 모든 객체에서 자유롭게 소유할 수 있다.
- 스레드의 소유권이 모호하기 때문에 스레드를 생성한 객체가 스레드를 소유한다고 가정한다.
    - 스레드 풀에서 생성된 모든 스레드는 스레드 풀에서 소유하고 관리한다.
- 스레드 기반 서비스에서 스레드의 시작부터 종료하는 메소드를 제공해야 한다. 애플리케이션에서 스레드 기반 서비스를 종료하면 스레드 기반 서비스는 소유한 모든 스레드를 종료하도록 한다.
- ExecutorService 인터페이스로 구현된 스레드 기반 서비스는 shutdown과 shutdownNow를 제공한다.
- 단순한 프로그램은 메인 메소드에서 전역 변수 형태로 ExcecutorService 인스턴스를 활용한다.
- 복잡한 프로그램에서는 ExecutorService를 다른 클래스 내부에 캡슐화해서 사용한다. 시작과 종료 기능을 ExecutorService와 연결해 스레드를 캡슐화해서 사용할 수 있다.
- 일련의 작업을 순서대로 처리해야 하며 작업이 모두 끝나기 전에는 반환하지 않은 메소드일 경우 메소드 내부에서 ExecutorService를 사용할 수 있다. 모든 작업이 끝난 후 Executor가 종료될 때까지 대기한다.
- shutdownNow를 호출하면 실행되지 않은 작업들이 반환된다. 하지만 실행됐지만 완료되지 않고 종료된 작업들은 알 수 없다.

프로듀서-컨슈머 패턴을 활용한 작업 종료도 같이 읽었는데, 내용이 아직 머리 속에서 잘 정리가 되지 않아서 다음에 다시 읽고 정리하려고 한다.
