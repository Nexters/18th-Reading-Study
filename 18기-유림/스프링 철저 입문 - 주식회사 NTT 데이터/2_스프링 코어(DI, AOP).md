> p15-30, 93-95



###### 2.1. DI

- 의존성 주입(Dependency Injection)

하나의 처리를 수행하기 위해 여러 개의 컴포넌트를 통합할 때. 각 컴포넌트의 인스턴스를 생성하고 통합 관리

어떤 컴포넌트는 싱글턴 객체로 만들어야 하고 어떤 컴포넌트는 프로토타입 객체로 만들어야 하는 등의 스코프 관리

각 인스턴스가 필요로 하는 공통 처리 코드를 외부에서 자동으로 끼워넣는 AOP 기능

들을 DI 컨테이너가 대신 해줌

- IoC 디자인 패턴

인스턴스를 제어하는 주도권이 역전된다는 의미. 컴포넌트를 구성하는 인스턴스의 생성과 의존 관계의 연결 처리를 해당 소스코드가 아닌 DI 컨테이너에서 대신해주기 때문에 제어가 역전되었다고 한다.



###### 2.1.2. ApplicationContext와 빈 정의

@Configuration과 @Bean 애너테이션을 사용해서 DI 컨테이너에 컴포넌트를 등록하면 애플리케이션은 DI컨테이너에서 있는 빈을 ApplicationContext 인스턴스를 통해 가져올 수 있다.

DI 컨테이너에 등록하는 컴포넌트를 빈이라고 하고, 이 빈에대한 설정 정보를 '빈 정의'라고 한다. DI 컨테이너에서 빈을 찾아오는 행위를 '룩업'이라고 한다.



###### 2.1.3. 빈 설정

- 자바 기반 설정 방식 / XML 기반 설정 방식

자바 코드 / XML로 빈을 설정. 애플리케이션에서 사용되는 모든 컴포넌트를 빈으로 정의해야한다.

- 애너테이션 기반 설정 방식

빈을 정의하는 애너테이션을 빈의 클래스에 부여한다. 이후 애너테이션이 붙은 클래스를 탐색해서 DI 컨테이너에 자동으로 등록한다(Component Scan). 또한 의존성 주입도 애너테이션이 붙어있으면 자동으로 주입하게 한다(Auto Wiring).

컴포넌트 스캔을 수행할 때는 스캔할 범위를 지정한다.

DI 컨테이너에 등록되는 빈의 이름은 클래스명의 첫 글자를 소문자로 바꾼 이름과 같다.명시적으로 빈의 이름을 지정하고 싶다면 @Component("")에 원하는 이름을 넣어주면 된다.



###### 2.2.6. 스프링 프로젝트에서 활용되는 AOP 기능

- 트랜잭션 관리

@Transactional 애너테이션을 통해 복잡한 트랜잭션 관리를 스프링에게 맡길 수 있다. 해당 메서드가 정상적으로 종료한 것이 확인되면 트랜잭션을 커밋하고, 예외가 발생하면 감지하여 트랜잭션을 롤백한다.

- 인가

권한 제어가 필요한 메서드에 @PreAuthorize 애너테이션을 지정하면 해당 메서드가 호출되기 전에 특정 인가 조건을 만족하는지 확인할 수 있다.

- 캐싱

@Cacheable 메서드의 매개변수 등을 키로 사용해 메서드의 실행 결과를 캐시로 관리할 수 있다.

- 비동기 처리

@Async를 사용하고 반환값으로 CompletableFuture 타입의 값이나 DeferredResult 타입의 값을 반환하게 만들면 AOP방식의 별도 스레드에서 실행된다.

- 재처리

@Retryable 해당 메서드가 정상적으로 처리되지 않은 경우, 원하는 조건을 만족할 때까지 재처리하게 된다. 신뢰성을 보장하기 어려운 외부 시스템과 연계해야 할 때 상당히 유용하다.

